@startuml Game_Initialization_Sequence

actor User
participant "BomberQuest\n(Main)" as BomberQuest
participant GameManager
participant SoundManager
participant SettingsManager
participant "JFrame" as Frame

User -> BomberQuest: main()
activate BomberQuest

BomberQuest -> GameManager: getInstance()
activate GameManager
GameManager --> BomberQuest: instance
deactivate GameManager

BomberQuest -> GameManager: init()
activate GameManager

GameManager -> SoundManager: getInstance()
activate SoundManager
SoundManager --> GameManager: instance
deactivate SoundManager

GameManager -> SoundManager: initSounds()
activate SoundManager

loop For each sound file
    SoundManager -> SoundManager: loadSound(name, path)
    note right
        Loads .wav files:
        - menu_theme.wav
        - battle_theme.wav
        - place_bomb.wav
        - boom.wav
        - damage.wav
        - death.wav
        - win.wav
    end note
end

SoundManager --> GameManager: Sounds loaded
deactivate SoundManager

GameManager -> SoundManager: playMusic(BGM_MENU)
activate SoundManager
SoundManager -> SoundManager: stopMusic()
SoundManager -> SoundManager: currentMusic.loop()
SoundManager --> GameManager
deactivate SoundManager

GameManager -> GameManager: setState(MAIN_MENU_STATE)

GameManager --> BomberQuest: Initialization complete
deactivate GameManager

BomberQuest -> Frame: new JFrame()
activate Frame
Frame --> BomberQuest
deactivate Frame

BomberQuest -> Frame: add(this)
BomberQuest -> Frame: pack()
BomberQuest -> Frame: setVisible(true)

BomberQuest -> BomberQuest: new Timer(16ms)
note right
    Timer triggers at ~60 FPS
    Calls actionPerformed()
    every 16ms
end note

BomberQuest -> BomberQuest: timer.start()

BomberQuest --> User: Show Main Menu
deactivate BomberQuest

loop Game Loop (60 FPS)
    BomberQuest -> GameManager: update()
    activate GameManager
    GameManager -> "CurrentState": update()
    GameManager --> BomberQuest
    deactivate GameManager
    
    BomberQuest -> BomberQuest: repaint()
    BomberQuest -> GameManager: render(g2d)
    activate GameManager
    GameManager -> "CurrentState": render(g2d, this)
    GameManager --> BomberQuest
    deactivate GameManager
end

@enduml
